const int knockPin = A0;
const int buzzerPin = 4;
const int buttonPin = 2;
int buzzer = 0;
int last = 0;
int prag = 50;
int knock = 0;
const int fiveSeconds = 5000;
const int interval = 1000;
long int lastEvent = 0;
int buzzerState = 0;
void setup() 
{
  pinMode(buzzerPin, OUTPUT);
  pinMode(buttonPin, INPUT_PULLUP);
  Serial.begin(9600);
}
void loop() 
{
  if(buzzer==1) 
  {
    int buttonState = 1-digitalRead(buttonPin);
    if(buttonState == 1) 
    {
      digitalWrite(buzzerPin, LOW);
      buzzer = buzzerState = knock = 0;
    }
    else 
    {
      if(millis() - lastEvent >= interval) 
      {
        buzzerState = 1 - buzzerState;
        digitalWrite(buzzerPin, buzzerState);
      }
    
    }
  }
  else {
    if(knock==1) 
    {
       if(millis() - last >= fiveSeconds) 
       {
         digitalWrite(buzzerPin, HIGH);
         buzzer = buzzerState = knock = 1;
       }
    }
    else 
    {
        knock = 1;
        last = millis();
    }
  }
  lastEvent = millis();
}
